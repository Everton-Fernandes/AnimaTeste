<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <title>Hub Docente - Próximos Eventos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>📅 Hub Docente - Próximos Eventos</h1>
    <div class="events-container" id="list"></div>

    <script>
      function formatDate(isoString) {
        const date = new Date(isoString);
        return date.toLocaleString("pt-BR", {
          day: "2-digit",
          month: "2-digit",
          year: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      async function load() {
        // Troque essa URL pelo seu backend Python, ex: http://localhost:5000/events
        const resp = await fetch("../data/sample_events.json");
        const data = await resp.json();

        const list = document.getElementById("list");
        data.value.forEach((ev) => {
          const div = document.createElement("div");
          div.className = "card";
          div.innerHTML = `
          <div>
            <div class="title">${ev.subject}</div>
            <div class="meta">
              <div><span class="icon">🕒</span><strong>Início:</strong> ${formatDate(
                ev.start.dateTime
              )}</div>
              <div><span class="icon">🏁</span><strong>Fim:</strong> ${formatDate(
                ev.end.dateTime
              )}</div>
              <div><span class="icon">📍</span><strong>Local:</strong> ${
                ev.location.displayName || "Não informado"
              }</div>
              <div><span class="icon">👤</span><strong>Organizador:</strong> ${
                ev.organizer.emailAddress.name
              }</div>
            </div>
          </div>
        `;
          list.appendChild(div);
        });
      }
      load();
    </script>
    <script src="https://res.cdn.office.net/teams-js/2.16.0/js/MicrosoftTeams.min.js"></script>
    <script>
      microsoftTeams.app.initialize().then(() => {
        console.log("Teams App initialized");
      });
    </script>
  </body>
</html>
